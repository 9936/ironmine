<style type="text/css">
.requiredInput {
   width: auto;

}

</style>
<%= form_for(@data_share_rule,:url=>{:action=>"update"},:builder => LabellingFormBuilder) do |f| %>
<div id="ep" class="edit-block page-block">
  <div class="pbHeader">
    <table cellpadding="0" cellspacing="0" border="0">
      <tbody>
        <tr>
          <td class="pbTitle"><h2 class="mainTitle"><%=t(:label_irm_data_share_rule)%></h2></td>
          <td id="topButtonRow" class="pbButton">
            <div class="button"><%= f.submit t(:save)%></div>
            <div class="button"><%= link_back t(:cancel)%></div>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
  <div class="pbBody">
    <%= error_for @data_share_rule %>
    <div id="head_1_ep" class="pbSubheader first tertiaryPalette">
      <span class="pbSubExtra">
        <span class="requiredLegend">
          <span class="requiredExampleOuter">
            <span class="requiredExample">&nbsp;</span>
          </span><span class="requiredMark">*</span>
          <span class="requiredText"> = <%=t(:label_is_required)%></span>
        </span>
      </span>
      <h3><%= t(:label_irm_data_share_rule_step1) %></h3>
    </div>
    <div class="pbSubsection">
      <table class="detailList" cellpadding="0" cellspacing="0" border="0">
        <tbody>
            <tr>
              <td class="labelCol"><label for="code"><%=t(:code)%></label></td>
              <td class="dataCol"><%=f.text_field :code , :required=>true ,:id=>"code",:irm_uppercase=>true%></td>
              <td class="labelCol empty"><%= f.hidden_field(:rule_type,:value=>"BASE_ON_REPORT_OWNER") %>&nbsp;</td>
              <td class="dataCol empty"><%= f.hidden_field(:business_object_id ,:value=>@data_share_rule[:business_object_id] ) %>&nbsp;</td>
            </tr>
            <tr>
              <td class="labelCol"><label for="name"><%=t(:name)%></label></td>
              <td class="dataCol"><%=f.text_field :name, :required=>true ,:id=>"name"%></td>
              <td class="labelCol empty">&nbsp;</td>
              <td class="dataCol empty">&nbsp;</td>
            </tr>
        </tbody>
      </table>
    </div>
  </div>
  <div class="pbBody">

    <div  class="pbSubheader first tertiaryPalette">

      <h3><%= t(:label_irm_data_share_rule_step2) %></h3>
    </div>
    <div class="pbSubsection">
      <table class="detailList" cellpadding="0" cellspacing="0" border="0">
        <tbody>
            <tr>
              <td class="labelCol"><label for="code"><%=t(:label_irm_data_share_rule_belong_to)%></label></td>
              <td class="dataCol"><div id="step2" class="floatLeft  float-left"  >

           <%=f.select :source_type,available_types,{},{:required=>true,:id=>"source_type"}%>
           <%=f.select :source_id,     [],
                                         {},
                                            {
                                             :id=>"source_id" ,
                                             :depend=>"source_type",
                                             :origin_value=>@data_share_rule.source_id,
                                             :blank=> "--- #{t(:actionview_instancetag_blank_option)} ---",
                                             :href=>url_for(:controller=>"irm/data_share_rules",:action=>"get_option",:format=>"json",
                                                            :subject_type=>"${source_type}")}%>

        </div></td>
              <td class="labelCol empty">
                </td>
              <td class="dataCol empty">&nbsp;</td>
            </tr>

          </tbody>
      </table>
    </div>
  </div>
    <div class="pbBody">

    <div   class="pbSubheader first tertiaryPalette">

      <h3><%= t(:label_irm_data_share_rule_step3) %></h3>
    </div>
    <div class="pbSubsection">
      <table class="detailList" cellpadding="0" cellspacing="0" border="0">
        <tbody>
        <tr>
                     <td class="labelCol"><label for="code"><%=t(:label_irm_data_share_rule_share_with)%></label></td>
                     <td class="dataCol"><div class="floatLeft  float-left" id="step3">

                  <%=f.select :target_type,available_types,{},{:required=>true, :id=>"target_type"}%>
                  <%=f.select :target_id,     [],
                                                {},
                                                   {:id=>"target_id" ,
                                                    :depend=>"target_type",
                                                    :origin_value=>@data_share_rule.target_id,
                                                    :blank=> "--- #{t(:actionview_instancetag_blank_option)} ---",
                                                    :href=>url_for(:controller=>"irm/data_share_rules",:action=>"get_option",:format=>"json",
                                                                   :subject_type=>"${target_type}")}%>

                       </div></td>
                     <td class="labelCol empty"></td>
                     <td class="dataCol empty">&nbsp;</td>
                   </tr>

                  </tbody>
      </table>
    </div>
  </div>
    <div class="pbBody">

    <div   class="pbSubheader first tertiaryPalette">

      <h3><%= t(:label_irm_data_share_rule_step4) %></h3>
    </div>
    <div class="pbSubsection">
      <table class="detailList" cellpadding="0" cellspacing="0" border="0">
        <tbody>
           <tr>
                     <td class="labelCol"><label for="code"><%=t(:label_irm_data_access)%></label></td>
                     <td class="dataCol"><div class="floatLeft  float-left">
                 <%=f.select :access_level,available_access_level,{},{:required=>true,:id=>"access_level",:name=>"irm_data_share_rule[access_level]"}%>

               </div></td>
                     <td class="labelCol empty">&nbsp;</td>
                     <td class="dataCol empty">&nbsp;</td>
                   </tr>
        </tbody>
      </table>
    </div>
  </div>
  <div class="pbBottomButtons">
    <table cellpadding="0" cellspacing="0" border="0">
      <tbody>
        <tr>
          <td class="pbTitle"></td>
          <td id="bottomButtonRow" class="pbButtonb">
            <div class="button"><%= f.submit t(:save)%></div>
            <div class="button"><%= link_back t(:cancel)%></div>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
<% end %>
<script type="text/javascript">
  $(function(){
     if($("#source_type")){
        $("#source_type").cascade("#source_id");
     }
     if($("#target_type")){
        $("#target_type").cascade("#target_id");
     }
  });
</script>