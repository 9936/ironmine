<%= page_title %>
<div class="filterOverview">
    <div class="bFilterView">
      <%= form_tag(:action => "select_permissions", :function_id=>@function) do %>
      <%= hidden_field_tag "return_url",@return_url%>
      <span class="bFilter">
        <label style="text-align: left; font-weight: bold; padding-right: 0.69em;"><%= t(:label_irm_permission_name) %>ï¼š</label>
        <span class="fBody">
            <%= text_field_tag :permission_name,@permission_name%>
            <%= submit_tag t(:search), :title => t(:search), :class => "btn" %>
        </span>
        <span class="fFooter">
        </span>
      </span>
      <% end %>
    </div>
</div>
<% if @permission_name && !@permission_name.blank? %>
<%= form_tag({:action => 'add_permissions',:function_id => @function}) do%>
<%= hidden_field_tag "return_url", @return_url%>
<%= hidden_field_tag "function_code", @function.function_code%>
<div class="srch">
    <div class="pbHeader">
        <table cellpadding="0" cellspacing="0" border="0">
          <tbody>
            <tr>
              <td class="pbTitle"><h2 class="mainTitle"><%= t(:label_irm_select_result) %>&nbsp;<%= t(:label_detail_info) %></h2></td>
              <td id="topButtonRow1" class="pbButton">
                <div class="button"><%= submit_tag t(:save)%></div>
                <% if !@return_url.blank? %>
                  <div class="button"><%= link_to t(:cancel), @return_url%></div>
                <% else %>
                  <div class="button"><%= link_to t(:cancel), {:action => "select_permissions",:function_id=>@function}%></div>
                <% end %>
              </td>
            </tr>
          </tbody>
        </table>
    </div>
</div>
<div id="ep" class="bEditBlock bPageBlock">
  <div class="pbBody">
        <div id="owned_permissions_list" class="datatable" style="width:100%;">
          <div id="id" style="display:none">
             <%= check_box_tag "irm_function_permissions[ids][]","{id}"%>
          </div>
        </div>
        <%= datatable("owned_permissions_list",url_for(:action=>"get_available_permissions", :function_code=>@function.function_code, :permission_name => @permission_name),
                  [{:key=>"id",:label=>t(:operation),:formatter=>"Y.irm.template",:width=>"20px"},
                   {:key=>"permission_code",:label=>t(:label_irm_permission_permission_code),:sortable=>true},
                   {:key=>"name",:label=>t(:label_irm_permission_name),:sortable=>true},
                   {:key=>"page_controller",:label=>t(:label_irm_permission_page_controller),:sortable=>true},
                   {:key=>"page_action",:label=>t(:label_irm_permission_page_action),:sortable=>true}
                   ],
                   {:row_perpage=>5})%>
  </div>
</div>
<% end %>
<% end %>