<% require_jscss(:newhighcharts) %>
<style>
  #daily_chart{
      min-width: 750px;
      height: 562px;
      margin: 0 auto
  }
</style>

<table style="width:100%;table-layout:fixed" >
<tr>
  <td>
    <div id="daily_chart"></div>
  </td>
</tr>
</table>

<script type="text/javascript">

    $(function () {
        $('#daily_chart').highcharts({
            title: {
                text: 'Amount of incident(historical)',
                x: -20 //center
            },
            subtitle: {
                x: -20
            },
            xAxis: {
                categories: ['<%= @table_a_date.join("','")%>'],
                labels: {
                    style: {
                        fontSize: '10px'
                    }
                }
            },
            yAxis: [{
                title: {
                    text: 'Daily & Daily Close'
                },
                plotLines: [{
                    value: 0,
                    width: 1,
                    color: '#808080'
                }],
                min:0
            }],
            colors: ['#EF305B','#60D267','#7cb5ec','#434343'],
            tooltip: {
//                valueSuffix: '°C'
            },
            legend: {
                layout: 'vertical',
                align: 'right',
                verticalAlign: 'middle',
                borderWidth: 0
            },
            plotOptions: {
                line: {
                    dataLabels: {
                        enabled: true
                    },
                    enableMouseTracking: false
                }
            },
            series: [{
                type: 'line',
                name: '14 Days Avg Created',
                data: [<%= @daily_avg_open.join(',')%>],
                dataLabels: {
                    enabled: false,
                    rotation: -90,
                    color: '#000000',
                    align: 'right',
                    x: 4,
                    y: 10,
                    style: {
                        fontSize: '13px',
                        fontFamily: 'Verdana, sans-serif',
                        textShadow: '0 0 3px black'
                    }
                }
            }, {
                type: 'line',
                name: '14 Days Avg Closed',
                data: [<%= @daily_avg_close.join(',')%>],
                dataLabels: {
                    enabled: false,
                    rotation: -90,
                    color: '#000000',
                    align: 'right',
                    x: 4,
                    y: 10,
                    style: {
                        fontSize: '13px',
                        fontFamily: 'Verdana, sans-serif',
                        textShadow: '0 0 3px black'
                    }
                }
            }, {
                type: 'column',
                name: 'Daily Created',
                data: [<%= @daily_open.join(',')%>],
                dataLabels: {
                    enabled: true,
                    rotation: 0,
                    color: '#000000',
                    align: 'right',
                    x: 4,
                    y: -1,
                    style: {
                        fontSize: '13px',
                        fontFamily: 'Verdana, sans-serif',
                        textShadow: '0 0 3px black'
                    }
                }
            }, {
                type: 'column',
                name: 'Daily Closed',
                data: [<%= @daily_close.join(',')%>],
                dataLabels: {
                    enabled: true,
                    rotation: 0,
                    color: '#000000',
                    align: 'right',
                    x: 4,
                    y: -1,
                    style: {
                        fontSize: '13px',
                        fontFamily: 'Verdana, sans-serif',
                        textShadow: '0 0 3px black'
                    }
                }
            } ]
        });
    });
    function myrefresh()
    {
        window.location.reload();
    }
    setTimeout('myrefresh()',30000); //指定90秒刷新一次

</script>

