<% content_for :add_phase_controll_bar do %>

    <%= form_tag({:controller => "dem/dev_managements",:action=>"create_phase"},) do |f|%>
        <%= hidden_field_tag(:dev_management_id, @dev_management.id, :id=>"dev_management_id")  %>
        <%= select_tag_alias :dev_phase_template_id, dem_get_phases_list,{},{:id=>"dev_phase_template_id"}%>
        <%= submit_tag("Add Phase",{:id=>"formSubmit",:class=>"btn btn-primary"})  %>
    <% end  %>
<% end %>

<%= form_for(@dev_management,:url=>{:action=>"update"},:builder => CustomFormBuilder,:html => { :multipart => true }) do |f| %>

  <%= hidden_field_tag :return_url,@return_url %>
  <% content_for :dev_management do %>
    <table class="form-table">
      <tbody>
      <tr>
        <td class="label-col"><label>Project</label></td>
        <td class="data-col">
          <%= f.select :project, options_for_select(get_project_list, @dev_management.related_project), {}, {:required=>true}%>
        </td>
        <td class="label-col"><label>Gap No.</label></td>
        <td class="data-col">
          <%= f.text_field :gap_no, :required=>true%>
        </td>
      </tr>
      <tr>
        <td class="label-col"><label>Related Project</label></td>
        <td class="data-col">
          <%= f.select :related_project, nullable_options_for_select(get_project_list, @dev_management.related_project)%>
        </td>
        <td class="label-col"><label>Related Project Gap No.</label></td>
        <td class="data-col">
          <%= f.text_field :related_project_gap_no%>
        </td>
      </tr>
      <tr>
        <td class="label-col"><label>Name</label></td>
        <td class="data-col">
          <%= f.text_field :name%>
        </td>
      </tr>
      <tr>
        <td class="label-col"><label>Description</label></td>
        <td class="data-col" colspan="3">
          <%= f.text_area :description, :style => "width:100%", :rows => "5", :cols=>"200"%>
        </td>
      </tr>
      <tr>
        <td class="label-col"><label>Investigation Result</label></td>
        <td class="data-col" colspan="3" >
          <%= f.text_area :investigation_result, :style => "width:100%", :rows => "5", :cols=>"200"%>
        </td>
      </tr>
      <tr>
        <td class="label-col"><label>Company</label></td>
        <td class="data-col">
          <%= f.text_field :company%>
        </td>
        <td class="label-col"><label>Category</label></td>
        <td class="data-col">
          <%= f.text_field :category%>
        </td>
      </tr>
      <tr>
         <td class="label-col"><label>System</label></td>
         <td class="data-col">
           <%= f.text_field :system%>
         </td>
         <td class="label-col"><label>Priority2</label></td>
         <td class="data-col">
           <%= f.text_field :priority2%>
         </td>
      </tr>
      <tr>
         <td class="label-col"><label>Designated Module</label></td>
         <td class="data-col">
           <%= f.text_field :designated_module%>
         </td>
         <td class="label-col"><label>Owner</label></td>
         <td class="data-col">
           <%= f.text_field :owner%>
         </td>
      </tr>
      <tr>
         <td class="label-col"><label>Classification(开发方式)</label></td>
         <td class="data-col">
           <%= f.text_field :classification%>
         </td>
         <td class="label-col"><label>类型(Type)</label></td>
         <td class="data-col">
           <%= f.text_field :dev_type%>
         </td>
      </tr>
      <tr>
         <td class="label-col"><label>难度</label></td>
         <td class="data-col">
           <%= f.text_field :dev_difficulty%>
         </td>
         <td class="label-col"><label>GT/Local</label></td>
         <td class="data-col">
           <%= f.text_field :gt_local%>
         </td>
      </tr>
      <tr>
         <td class="label-col"><label>Status</label></td>
         <td class="data-col">
           <%= f.text_field :dev_status%>
         </td>
         <td class="label-col"><label>完成阶段</label></td>
         <td class="data-col">
           <%= f.text_field :completed_phase%>
         </td>
      </tr>     addon_priority
      <tr>
         <td class="label-col"><label>Addon Priority</label></td>
         <td class="data-col">
           <%= f.text_field :addon_priority%>
         </td>
      </tr>
      </tbody>
    </table>
  <% end%>

  <!--页面结构-->
  <div class="page-block">
    <div class="page-block-body">
    <table class="page-block-header"><tr>
      <td class="page-block-title">
        <h2 class="block-title">Edit Development Management</h2>
      </td>
      <td class="page-block-button">
        <%= link_submit t(:save),{:class=>"btn btn-primary"}%>
        <% if @return_url%>
          <%= link_to t(:cancel), @return_url,{:class=>"btn cancel"}%>
        <% else %>
          <%= link_back t(:cancel),{},{:class=>"btn cancel"}%>
        <% end %>
      </td>
    </tr></table>
    <%= error_for @dev_management %>
    <div class="page-block-body">
      <div class="sub-page-block">
        <div class="sub-page-block-header">
          <h3 class="sub-page-block-title">Basic Info.</h3>
          <span class="required-help-info"> = <%=t(:label_is_required)%></span>
        </div>
        <div class="sub-page-block-body">
          <%= content_for :dev_management %>
        </div>
      </div>

      <% @dev_phases.each do |dp|%>
        <%= render :partial => "phase_edit", :locals => {:phase => dp}%>
      <% end if @dev_phases.present? %>

    </div>

    <table class="page-block-footer"><tr>
      <td class="page-block-title">
      </td>
      <td class="page-block-button">
        <%= link_submit t(:save),{:class=>"btn btn-primary"}%>
        <% if @return_url%>
          <%= link_to t(:cancel), @return_url,{:class=>"btn cancel"}%>
        <% else %>
          <%= link_back t(:cancel),{},{:class=>"btn cancel"}%>
        <% end %>
      </td>
    </tr></table>
  </div>
</div>
<% end %>

<div class="page-block">
  <div class="page-block-body">
    <div class="sub-page-block">
      <div class="sub-page-block-header">
        <h3 class="sub-page-block-title">Add Phase</h3>
      </div>
      <div class="sub-page-block-body">
        <%= content_for :add_phase_controll_bar %>
      </div>
    </div>
  </div>
</div>