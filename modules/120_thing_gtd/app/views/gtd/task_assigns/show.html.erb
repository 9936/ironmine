<%= common_title %>
<!--页面结构-->
<div class="show-block">
  <table class="page-block-header">
    <tr>
      <td class="page-block-title">
        <h2 class="block-title"><%= t(:label_gtd_task_assign) %></h2>
      </td>
      <td class="page-block-button">
        <%= link_to t(:edit), {:action => "edit", :id => @task_assign}, :class => "btn" %>
        <%= link_to t(:back), {:action => "index"}, :class => "btn" %>
      </td>
    </tr>
  </table>
  <div class="page-block-body">
    <table class="show-table">
      <tbody>
      <tr>
        <td class="label-col"><label><%= t(:label_gtd_task_assign_name) %></label></td>
        <td class="data-col"><%= @task_assign.name %></td>
        <td class="label-col"></td>
        <td class="data-col"></td>
      </tr>
      <tr>
        <td class="label-col"><label><%= t(:label_gtd_task_assign_description) %></label></td>
        <td class="data-col"><%= @task_assign.description %></td>
        <td class="label-col"></td>
        <td class="data-col"></td>
      </tr>
      </tbody>
    </table>
  </div>
</div>


<!-- 显示分派层次 分派者 -->
<div class="page-block" id="assignFrom">
  <table class="page-block-header">
    <tr>
      <td class="page-block-title">
        <h2 class="block-title"><%= t(:label_gtd_task_assign_people_from) %></h2>
      </td>
      <td class="page-block-button">
        <%= form_for(@task_assign, :url => {:action => "delete_member",:type=>"from",:_dom_id=>"assignFrom"},:html=>{:style=>"margin:0;"}, :builder => CustomFormBuilder) do |f| %>
            <%= f.hidden_field(:temp_from_id_string, :value => "") %>
            <%= link_submit t(:delete_selected), :confirm => t(:label_are_you_sure), :class => "btn btn-danger" %>
        <% end %>
      </td>
      <td class="page-block-help" id="assignFromForm">
        <%= render :partial => "gtd/task_assigns/mini_form", :locals => {:task_assign => @task_assign, :lov_name => "task_assign_from", :member_type => "from", :dom_id => "assignFrom"} %>
      </td>
    </tr>
  </table>
  <div class="page-block-body">
    <%= datatable("task_assign_from_people", {:action => "get_from_people_data"}, [], {:paginator_box => "from_paginator",:select=>"multiple"}) %>
  </div>
</div>


<!-- 显示分派层次 被分派者 -->
<div class="page-block" id="assignTo">
  <table class="page-block-header">
    <tr>
      <td class="page-block-title">
        <h2 class="block-title"><%= t(:label_gtd_task_assign_people_to) %></h2>
      </td>
      <td class="page-block-button">
        <%= form_for(@task_assign, :url => {:action => "delete_member",:type=>"to",:_dom_id=>"assignTo"},:html=>{:style=>"margin:0;"}, :builder => CustomFormBuilder) do |f| %>
            <%= f.hidden_field(:temp_to_id_string, :value => "") %>
            <%= link_submit t(:delete_selected), :confirm => t(:label_are_you_sure), :class => "btn btn-danger" %>
        <% end %>
      </td>
      <td class="page-block-help" id="assignToForm">
        <%= render :partial => "gtd/task_assigns/mini_form", :locals => {:task_assign => @task_assign, :lov_name => "task_assign_to", :member_type => "to", :dom_id => "assignTo"} %>
      </td>
    </tr>
  </table>
  <div class="page-block-body" id="book_entry_headers">
    <%= datatable("task_assign_to_people", {:action => "get_to_people_data"}, [], {:paginator_box => "to_paginator",:select=>"multiple"}) %>
  </div>
</div>

<script type="text/javascript">
    $(document).ready(function () {
        $("#task_assign_to_people").bind('selectionchange', function (event, ids) {
            $("#gtd_task_assign_temp_to_id_string").val(ids.join(","));
        });

        $("#task_assign_from_people").bind('selectionchange', function (event, ids) {
            $("#gtd_task_assign_temp_from_id_string").val(ids.join(","));
        });
    });


</script>
